<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Post-Op Patient Portal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="/static/style.css" />
  
</head>
<body class="min-h-screen bg-slate-50 text-slate-900">

  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
      <div class="flex items-center gap-3">
        <svg class="h-8 w-8 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z" />
          <path d="M12 8v4l3 3" />
        </svg>
        <h1 class="text-xl font-semibold text-slate-800">Post-Op Patient Portal</h1>
      </div>
      <button id="logoutBtn" class="hidden px-4 py-2 rounded-lg bg-slate-100 text-slate-700 text-sm font-medium hover:bg-slate-200 transition-colors">
        Logout
      </button>
    </div>
  </header>

  <div class="max-w-6xl mx-auto p-4">
    <div id="error" class="hidden mt-3 p-3 rounded-2xl bg-rose-50 text-rose-700 border border-rose-200 text-sm"></div>

    <section id="loginCard" class="mt-6 max-w-md bg-white p-6 rounded-2xl shadow-lg mx-auto">
      <h2 class="text-2xl font-bold text-center text-slate-800 mb-6">Welcome Back</h2>
      <div class="grid gap-4">
        <label class="grid gap-1.5 text-sm">
          <span class="font-medium text-slate-600">User ID</span>
          <input id="userId" class="inp" placeholder="alice" />
        </label>
        <label class="grid gap-1.5 text-sm">
          <span class="font-medium text-slate-600">Password</span>
          <input id="password" type="password" class="inp" placeholder="••••••••" />
        </label>
        <button id="loginBtn" class="mt-4 w-full px-4 py-3 rounded-xl bg-blue-600 text-white font-semibold shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
          Sign in
        </button>
      </div>
    </section>

    <section id="appSection" class="hidden mt-6">
      <div id="patientContainer" class="max-w-3xl mx-auto">
        <div id="chatWrap" class="bg-white rounded-2xl shadow-lg flex flex-col h-[80svh]">
          <div class="px-5 py-4 border-b border-slate-200 text-sm text-slate-600 font-medium">
            Chatting as <b id="pid" class="text-slate-900">—</b>
          </div>
          <div id="messages" class="flex-1 overflow-auto p-4 space-y-4 text-sm">
            </div>
          <form id="chatForm" class="p-3 border-t border-slate-200 flex gap-3 bg-slate-50 rounded-b-2xl">
            <input id="chatInput" class="flex-1 px-4 py-2.5 rounded-xl border border-slate-300 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type your message…" />
            <button class="px-5 py-2.5 rounded-xl bg-blue-600 text-white font-semibold shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
              Send
            </button>
          </form>
        </div>
      </div>

      <div id="adminCard" class="hidden max-w-4xl mx-auto mt-6 bg-white rounded-2xl shadow-lg p-6">
        <h3 class="font-semibold text-xl mb-5">Doctor: Add New Patient</h3>
        <form id="addPatientForm" class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 text-sm">
          
          <div class="flex flex-col gap-5">
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Patient Login (user_id)</span>
              <input class="inp" placeholder="e.g., arthur" id="np_user_id" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Patient Record (patient_id)</span>
              <input class="inp" placeholder="e.g., p5" id="np_patient_id" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Full Name</span>
              <input class="inp" placeholder="Arthur Morgan" id="np_name" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Age</span>
              <input class="inp" placeholder="58" id="np_age" type="number" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Surgeon</span>
              <input class="inp" placeholder="Dr. Dutch" id="np_surgeon" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Procedure</span>
              <input class="inp" placeholder="Heart Operation" id="np_procedure" required>
            </label>
            
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Red Flags (one per line)</span>
              <textarea class="inp h-24" placeholder="trouble breathing&#10;heart rate increase" id="np_flags"></textarea>
            </label>
          </div>

          <div class="flex flex-col gap-5 min-h-0">
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Emergency Contact Name</span>
              <input class="inp" placeholder="Emergency OP 2" id="np_emname" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Emergency Contact Phone</span>
              <input class="inp" placeholder="+1-555-123-4567" id="np_emphone" required>
            </label>
            <label class="grid gap-1.5">
              <span class="font-medium text-slate-600">Allergies (comma separated)</span>
              <textarea class="inp" placeholder="pollen, peanuts" id="np_allergies"></textarea>
            </label>
            
            <div class="flex flex-col gap-3 min-h-0">
              <span class="font-medium text-slate-600">Medications</span>
              
              <label class="grid gap-1.5 text-xs">
                <span class="font-medium text-slate-500">Name</span>
                <input class="inp" placeholder="e.g., Aspirin" id="np_med_name">
              </label>
              
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <label class="grid gap-1.5 text-xs">
                  <span class="font-medium text-slate-500">Dose</span>
                  <input class="inp" placeholder="81mg" id="np_med_dose">
                </label>
                <label class="grid gap-1.5 text-xs">
                  <span class="font-medium text-slate-500">Frequency</span>
                  <input class="inp" placeholder="daily" id="np_med_freq">
                </label>
              </div>
              
              <button type="button" id="addMedBtn" class="w-full px-3 py-2 rounded-lg bg-blue-600 text-white font-semibold text-sm hover:bg-blue-700 transition-colors">
                Add Medication
              </button>
              
              <div id="medsListContainer" 
                   class="flex flex-col text-xs max-h-64 overflow-y-auto rounded-lg border border-slate-200 bg-slate-50">
                </div>
            </div>
            </div>

          <div class="md:col-span-2 mt-4">
            <button class="w-full px-3 py-3 rounded-xl bg-emerald-600 text-white font-medium shadow-md hover:bg-emerald-700 transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2">
              Add Patient
            </button>
          </div>
        </form>
      </div>
    </section>
  </div>

  <div id="popup" class="flex items-center w-full max-w-xs p-4 space-x-4 text-gray-500 bg-white divide-x divide-gray-200 rounded-lg shadow-2xl" role="alert">
    <div id="popup-icon-container">
      </div>
    <div id="popup-message" class="pl-4 text-sm font-medium">
      Message here
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>